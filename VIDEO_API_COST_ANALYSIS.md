# 视频平台 API 成本分析

## 支持的平台

1. **YouTube** - YouTube Data API v3
2. **Bilibili** - Bilibili API
3. **抖音 (Douyin)** - 抖音开放平台 API

---

## 成本分析

### 1. YouTube Data API v3

**免费配额**:
- 每天 **10,000 单位配额**（免费）
- 大多数操作消耗 1 单位配额
- 获取视频元数据：1 单位
- 获取字幕/转录：1 单位

**超出配额后**:
- 需要向 Google 申请额外配额
- 可能需要付费（具体费用需与 Google 协商）
- 通常对于教育/非商业用途，可以申请更多免费配额

**成本评估**: ⭐⭐⭐⭐⭐ (几乎免费，配额充足)

---

### 2. Bilibili API

**官方 API**:
- 主要面向站内开发者
- 公开文档较少
- 需要申请开发者权限

**第三方服务** (推荐):
- **OneAPI** 等服务商提供 Bilibili API
- 价格：约 **0.03 元人民币/次调用**
- 获取视频信息：0.03 元
- 获取字幕/转录：0.03 元

**成本评估**: ⭐⭐⭐ (中等成本，每次调用约 3 分钱)

---

### 3. 抖音 (Douyin) API

**官方 API**:
- 需要企业认证：**600 元/年**
- 支付接口押金：**20,000 元**（可退还）
- 适合企业级应用

**第三方服务** (推荐):
- **OneAPI** 等服务商提供抖音 API
- 价格：约 **0.03 元人民币/次调用**
- 获取视频信息：0.03 元
- 获取视频详情：0.03 元

**成本评估**: ⭐⭐⭐ (中等成本，每次调用约 3 分钱)

---

## 总成本估算

### 场景 1: 小规模使用（每月 100 个视频）

| 平台 | 调用次数 | 单价 | 月成本 |
|------|---------|------|--------|
| YouTube | 100 | 免费 | ¥0 |
| Bilibili | 100 | ¥0.03 | ¥3 |
| 抖音 | 100 | ¥0.03 | ¥3 |
| **总计** | 300 | - | **¥6/月** |

### 场景 2: 中等规模使用（每月 1,000 个视频）

| 平台 | 调用次数 | 单价 | 月成本 |
|------|---------|------|--------|
| YouTube | 1,000 | 免费 | ¥0 |
| Bilibili | 1,000 | ¥0.03 | ¥30 |
| 抖音 | 1,000 | ¥0.03 | ¥30 |
| **总计** | 3,000 | - | **¥60/月** |

### 场景 3: 大规模使用（每月 10,000 个视频）

| 平台 | 调用次数 | 单价 | 月成本 |
|------|---------|------|--------|
| YouTube | 10,000 | 免费 | ¥0 |
| Bilibili | 10,000 | ¥0.03 | ¥300 |
| 抖音 | 10,000 | ¥0.03 | ¥300 |
| **总计** | 30,000 | - | **¥600/月** |

**注意**: YouTube 每天有 10,000 单位配额限制，如果超过需要申请额外配额。

---

## 成本优化策略

### 1. 缓存机制
- 相同视频 URL 不重复调用 API
- 使用内容哈希去重（已实现）
- 缓存视频元数据和转录结果

### 2. 配额管理
- 优先使用 YouTube（免费）
- 对 Bilibili 和抖音设置使用限制
- 为 Pro 用户提供更多视频处理配额

### 3. 降级方案
- 如果 API 调用失败，使用 Whisper API 进行语音转文字
- Whisper API 成本：约 $0.006/分钟音频
- 对于 10 分钟视频 ≈ $0.06 (约 ¥0.42)

### 4. 用户分层
- **Free 用户**: 每月限制视频处理次数（如 5 次）
- **Pro 用户**: 更高的配额（如 50 次/月）
- 超出配额后提示升级

---

## 实现方案

### 方案 A: 使用官方 API（推荐用于 YouTube）

**优点**:
- YouTube 完全免费（在配额内）
- 数据准确可靠
- 官方支持

**缺点**:
- Bilibili 和抖音官方 API 申请复杂
- 需要企业认证（抖音）

### 方案 B: 使用第三方服务（推荐用于 Bilibili 和抖音）

**优点**:
- 申请简单，无需企业认证
- 统一接口，易于集成
- 价格透明

**缺点**:
- 需要额外成本（每次 0.03 元）
- 依赖第三方服务稳定性

### 方案 C: 混合方案（推荐）

**YouTube**: 使用官方 API（免费）
**Bilibili**: 使用第三方服务（OneAPI 等）
**抖音**: 使用第三方服务（OneAPI 等）

**优点**:
- 成本最低
- 灵活性高
- 可以逐步迁移到官方 API

---

## 额外成本考虑

### 1. Whisper API（备用方案）
- 当平台 API 无法获取字幕时使用
- 成本：$0.006/分钟
- 10 分钟视频 ≈ ¥0.42

### 2. OpenAI GPT-4o-mini（笔记生成）
- 已在使用，成本已包含
- 每次视频处理：约 $0.001-0.002

### 3. 服务器和带宽
- 视频元数据获取：几乎无成本
- 如果下载视频进行转录：带宽成本较高（不推荐）

---

## 推荐实施方案

### 阶段 1: MVP（最小可行产品）
1. **YouTube**: 使用官方 API（免费）
2. **Bilibili**: 使用第三方服务（OneAPI）
3. **抖音**: 使用第三方服务（OneAPI）
4. **成本**: 约 ¥6-60/月（取决于使用量）

### 阶段 2: 优化
1. 实现缓存机制
2. 添加配额管理
3. 实现降级方案（Whisper API）

### 阶段 3: 规模化
1. 考虑申请抖音官方 API（如果使用量大）
2. 与第三方服务商谈批量折扣
3. 实现智能路由（选择最便宜的方案）

---

## 总结

**成本评估**: ⭐⭐⭐ (中等成本)

- **小规模使用**: ¥6/月（非常便宜）
- **中等规模**: ¥60/月（可接受）
- **大规模使用**: ¥600/月（需要优化）

**建议**:
1. 先实现 YouTube 和 Bilibili（成本低）
2. 根据用户需求再添加抖音支持
3. 设置合理的用户配额限制
4. 考虑将视频处理作为 Pro 功能

**成本可控性**: ✅ 通过配额管理和缓存，成本可以很好地控制

