# Turbo AI ä¸‰å¤§åŠŸèƒ½åç«¯å®ç°æ£€æŸ¥æ¸…å•

## âœ… å·²å®Œæˆçš„ä¾èµ–å®‰è£…

### è§£æ/æ¸…æ´—
- âœ… `pdf-parse` - PDF æ–‡æœ¬æå–
- âœ… `mammoth` - DOCX æ–‡æœ¬æå–
- âœ… `remark` + `remark-gfm` - Markdown å¤„ç†
- âœ… `remove-markdown` - Markdown æ¸…æ´—

### ç»“æ„åŒ–è¾“å‡º
- âœ… `zod` - ç±»å‹éªŒè¯å’Œ schema æ ¡éªŒ
- âœ… `jsonrepair` - JSON ä¿®å¤ï¼ˆå¤„ç† LLM è¾“å‡ºä¸å®Œæ•´çš„æƒ…å†µï¼‰

### éŸ³é¢‘/è§†é¢‘å¤„ç†
- âœ… `ffmpeg-static` - FFmpeg é™æ€äºŒè¿›åˆ¶
- âœ… `fluent-ffmpeg` - FFmpeg Node.js å°è£…
- âœ… `ytdl-core` - YouTube è§†é¢‘ä¸‹è½½å’ŒéŸ³é¢‘æå–
- âœ… `youtube-transcript` - YouTube å­—å¹•æå–ï¼ˆå…è´¹ï¼‰

### RAG è½»æ£€ç´¢
- âœ… `minisearch` - è½»é‡çº§å…¨æ–‡æœç´¢ï¼ˆBM25 ç®—æ³•ï¼‰
- âœ… `sentence-splitter` - å¥å­åˆ†å‰²ï¼ˆç”¨äºæ›´å¥½çš„æ–‡æœ¬æ£€ç´¢ï¼‰

### é™æµå’Œè®¤è¯
- âœ… `@upstash/ratelimit` - é™æµæœåŠ¡
- âœ… `@upstash/redis` - Redis å®¢æˆ·ç«¯ï¼ˆé™æµéœ€è¦ï¼‰
- âœ… `bcryptjs` - å¯†ç å“ˆå¸Œ
- âœ… `jose` - JWT å¤„ç†

### æ—¥å¿—
- âœ… `pino` - é«˜æ€§èƒ½æ—¥å¿—åº“

## âœ… å·²å®ç°çš„æ ¸å¿ƒåŠŸèƒ½

### 1. æ–‡ä»¶ä¸Šä¼ æµæ°´çº¿ (`app/api/process/file/route.ts`)
- âœ… æ–‡ä»¶ç±»å‹ç™½åå•éªŒè¯ï¼ˆPDF, DOCX, TXT, MDï¼‰
- âœ… æ–‡ä»¶å¤§å°é™åˆ¶æ£€æŸ¥ï¼ˆMAX_FILE_MBï¼‰
- âœ… é¡µæ•°é™åˆ¶æ£€æŸ¥ï¼ˆåŸºäº planï¼‰
- âœ… ä½¿ç”¨ `lib/file-extractor.ts` ç»Ÿä¸€æå–é€»è¾‘
- âœ… è°ƒç”¨ç»Ÿä¸€ç”Ÿæˆå™¨ `generateLearningAsset`ï¼ˆä¸€æ¬¡ LLM è°ƒç”¨ï¼‰
- âœ… å­˜å‚¨åˆ° `lib/db.ts`ï¼ˆåŒ…å« token ä¼°ç®—ã€å…ƒæ•°æ®ï¼‰
- âœ… è¿”å› `{ sessionId }` ç»™å‰ç«¯
- âœ… è¿è¡Œæ—¶ï¼š`nodejs`
- âœ… è¯¦ç»†æ—¥å¿—ï¼ˆè§£æè€—æ—¶ã€å­—æ•°ã€token ä¼°ç®—ï¼‰

### 2. éŸ³é¢‘æµæ°´çº¿ (`app/api/process/audio/route.ts`)
- âœ… æ¥æ”¶ audio/webm|m4a|mp3
- âœ… æ–‡ä»¶å¤§å°é™åˆ¶æ£€æŸ¥ï¼ˆ25MBï¼‰
- âœ… éŸ³é¢‘æ ¼å¼éªŒè¯ï¼ˆä½¿ç”¨ ffmpegï¼‰
- âœ… æ—¶é•¿é™åˆ¶æ£€æŸ¥ï¼ˆåŸºäº planï¼‰
- âœ… å¯¹äº > TRANSCRIBE_CHUNK_SEC çš„éŸ³é¢‘ï¼Œä½¿ç”¨ `lib/audio-processor.ts` åˆ‡ç‰‡å¹¶å¹¶è¡Œè½¬å½•
- âœ… ä½¿ç”¨ `openai.audio.transcriptions.create`ï¼ˆWhisperï¼‰
- âœ… è°ƒç”¨ç»Ÿä¸€ç”Ÿæˆå™¨ `generateLearningAsset`
- âœ… å­˜å‚¨åˆ° `lib/db.ts`
- âœ… è¿”å› `{ sessionId }`
- âœ… è¿è¡Œæ—¶ï¼š`nodejs`
- âœ… è¿›åº¦äº‹ä»¶æ”¯æŒï¼ˆchunking, transcribing, generatingï¼‰

### 3. è§†é¢‘æµæ°´çº¿ (`app/api/process/video/route.ts`)
- âœ… è¯†åˆ«å¹³å°å’Œ IDï¼ˆ`lib/videoPlatforms.ts`ï¼‰
- âœ… ä¼˜å…ˆä½¿ç”¨ `youtube-transcript` æ‹‰å®˜æ–¹å­—å¹•ï¼ˆ0 æˆæœ¬ï¼‰
- âœ… å…œåº•ï¼š`ytdl-core` æŠ½éŸ³è½¨ â†’ `ffmpeg` è½¬ç  â†’ Whisper è½¬å½•
- âœ… è°ƒç”¨ç»Ÿä¸€ç”Ÿæˆå™¨ `generateLearningAsset`
- âœ… å­˜å‚¨åˆ° `lib/db.ts`
- âœ… è¿”å› `{ sessionId }`
- âœ… è¿è¡Œæ—¶ï¼š`nodejs`
- âœ… å¹³å°é™åˆ¶ï¼ˆALLOWED_VIDEO_PROVIDERSï¼‰
- âœ… Bilibili/Douyin å ä½å®ç°

### 4. ç»Ÿä¸€ç”Ÿæˆå™¨ (`lib/learning-asset-generator.ts`)
- âœ… OpenAI JSON æ¨¡å¼ï¼š`response_format: { type: "json_object" }`
- âœ… æ¸©åº¦ 0.5ï¼ˆ0.4-0.6 èŒƒå›´ï¼‰
- âœ… ä¸¤æ®µå¼å¤„ç†ï¼šè¶…é•¿æ–‡æœ¬å…ˆæ‘˜è¦å†ç”Ÿæˆ
- âœ… `jsonrepair` ä¿®å¤ JSON
- âœ… `zod.safeParse` æ ¡éªŒï¼Œå¤±è´¥é‡è¯• 1 æ¬¡
- âœ… Notes ç»“æ„ï¼šæ¦‚å¿µâ†’æ¨å¯¼â†’ä¾‹é¢˜â†’å°ç»“â†’è¡¨æ ¼ï¼ˆKaTeX æ”¯æŒï¼‰
- âœ… è¾“å‡ºå¯¹é½ `types/notra.ts` ç±»å‹

### 5. åŒèŠå¤©æ¨¡å¼ (`app/api/chat/route.ts`)
- âœ… General Chatï¼šé»˜è®¤ `gpt-4o-mini`ï¼Œæ”¯æŒ `gpt-4o`ã€`gpt-5.1`ï¼ˆPro-onlyï¼‰
- âœ… Chat with Noteï¼šè¾“å…¥ `sessionId` + `userQuery`
- âœ… ä½¿ç”¨ `lib/rag-search.ts` è¿›è¡Œè½»æ£€ç´¢ï¼ˆminisearch BM25ï¼‰
- âœ… åªæŠŠç›¸å…³ 3-6 æ®µæ‹¼æ¥åˆ° promptï¼ˆRAGï¼‰
- âœ… æµå¼è¾“å‡º
- âœ… è£å‰ªä¸Šä¸‹æ–‡ï¼ˆå…è´¹ 3 è½®ï¼ŒPro 5 è½®ï¼‰
- âœ… é™åˆ¶å›å¤é•¿åº¦ï¼ˆå…è´¹ 512 tokensï¼ŒPro 1024 tokensï¼‰
- âœ… è¿è¡Œæ—¶ï¼š`edge`ï¼ˆæ–‡æœ¬æµå¼æ¥å£ï¼‰

### 6. ç”¨é‡ä¸é™æµ
- âœ… `lib/rate-limiter.ts` - @upstash/ratelimit é›†æˆ
- âœ… å…è´¹/Pro åˆ†å±‚é…ç½®ï¼ˆ`config/usageLimits.ts`ï¼‰
- âœ… ç»Ÿä¸€é”™è¯¯æ ¼å¼ `{ code, message, hint }`

### 7. é”™è¯¯å¤„ç†
- âœ… ç»Ÿä¸€ error shapeï¼š`{ code, message, hint }`
- âœ… Edge / Node è·¯å¾„æ¸…æ™°
- âœ… æ‰€æœ‰ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿçš„ API éƒ½è®¾ç½®ä¸º `runtime = "nodejs"`

## ğŸ“‹ å®ç°çŠ¶æ€æ€»ç»“

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| ä¾èµ–å®‰è£… | âœ… å®Œæˆ | æ‰€æœ‰å¿…è¦ä¾èµ–å·²å®‰è£… |
| æ–‡ä»¶æµæ°´çº¿ | âœ… å®Œæˆ | å®Œæ•´å®ç°ï¼Œç¬¦åˆ Turbo é€»è¾‘ |
| éŸ³é¢‘æµæ°´çº¿ | âœ… å®Œæˆ | å®Œæ•´å®ç°ï¼Œæ”¯æŒåˆ‡ç‰‡å’Œå¹¶è¡Œè½¬å½• |
| è§†é¢‘æµæ°´çº¿ | âœ… å®Œæˆ | å®Œæ•´å®ç°ï¼Œå­—å¹•ä¼˜å…ˆ+å…œåº•è½¬å½• |
| ç»Ÿä¸€ç”Ÿæˆå™¨ | âœ… å®Œæˆ | JSON æ¨¡å¼+ä¸¤æ®µå¼+zod æ ¡éªŒ |
| åŒèŠå¤©æ¨¡å¼ | âœ… å®Œæˆ | General + Chat with Note + RAG |
| ç”¨é‡é™æµ | âœ… å®Œæˆ | @upstash/ratelimit é›†æˆ |
| é”™è¯¯å¤„ç† | âœ… å®Œæˆ | ç»Ÿä¸€æ ¼å¼ï¼Œè¿è¡Œæ—¶æ¸…æ™° |

## ğŸ¯ Turbo AI æ ¸å¿ƒç‰¹æ€§å¯¹æ¯”

| ç‰¹æ€§ | Turbo AI | Notra å®ç° | çŠ¶æ€ |
|------|----------|------------|------|
| ä¸€æ¬¡ LLM è°ƒç”¨ç”Ÿæˆå…¨éƒ¨èµ„äº§ | âœ… | âœ… | å®Œæˆ |
| ä¸¤æ®µå¼å¤„ç†ï¼ˆè¶…é•¿æ–‡æœ¬ï¼‰ | âœ… | âœ… | å®Œæˆ |
| JSON æ¨¡å¼ + å®¹é”™ | âœ… | âœ… | å®Œæˆ |
| éŸ³é¢‘åˆ‡ç‰‡å¹¶è¡Œè½¬å½• | âœ… | âœ… | å®Œæˆ |
| è§†é¢‘å­—å¹•ä¼˜å…ˆç­–ç•¥ | âœ… | âœ… | å®Œæˆ |
| è½»é‡çº§ RAG æ£€ç´¢ | âœ… | âœ… | å®Œæˆ |
| ç”¨é‡é™æµ | âœ… | âœ… | å®Œæˆ |

## âœ… ç»“è®º

**æ‰€æœ‰ Turbo AI ä¸‰å¤§åŠŸèƒ½çš„åç«¯è¿è¡Œé€»è¾‘å·²å®Œæ•´å®ç°ï¼Œæ‰€æœ‰å¿…è¦çš„æ’ä»¶éƒ½å·²å®‰è£…å¹¶æ­£ç¡®ä½¿ç”¨ã€‚**

